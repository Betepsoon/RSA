'''
frame 2,6,19
'''
from math import gcd
from rsa_package import common


def pollard_p_1(n, b):  # pollard p-1方法
	"""
	Factor n = p*q (p is b-smooth)
	:param n:
	:param b:
	:return: d = p
	"""
	# step 1
	a = 2
	result = 0
	# step 2
	for j in range(2, b):
		a = pow(a, j, n)
		result = gcd(a - 1, n)
		if 1 < result < n:
			return result


if __name__ == '__main__':
	n2 = int(
		'808627CED38A980D765454AC5DFEFC10195F6FEF9B35B52B742DBCE2419C34080A3EF3E9673FEA4DD629FF382155031EA6DCBA8372D42C1862F32B2BEE47E157FA7150C544635035F366F7D68234F56FA24180EB6A00A0F85C65AAEB455B8ED28F2285376CDA786F8C658CFEB3752F3504A7256EA3DBD22EEF20267D156FAB51',
		16)
	e2 = int('10001', 16)
	c2 = int(
		'38702EF6FD51CA1CA834EF495618DA956C8F8AD222B99E256ED5E3DD9089E194DE67FD427F6132715709830A73B1A1CB582E56D06AF8F31BBA2851DBA1A1C2985B7FC233018E42554C2AABD69A225F9283A164C3AA5479363F89260219F9964738B7C78C5D08618009F3904EB55A6A570E8D4B1701F4BF1B2C99C7887CCFF2C9',
		16)

	n6 = int(
		'D11B49BF43234D6595219AB7C21730DE0A13A7A01E63831A4D4F8DC5A7E68FCA0E9768EF0DABCAD036E08E17E4B27C1151DF364556D8F93D19565D9F40F095A49C6185F2630671EB5EC1EAA514BEC32D93A0F0459B52F1E34D4B9113413403F66619262EF1D3CBB025648C997CD1438DE21CFE4BEA0C6E00C72FFDE587929CB3',
		16)
	e6 = int('10001', 16)
	c6 = int(
		'4333AF6B43F36028D8D9650EC3EED3238541EE5C15E626C58C9EC33674A6D08D5B1F2580A1A0B07E9D853536CD994E197889D122701A62BB2A9E79559F3D5281014535F6C54F83CA8D9700EEB67D99AF318D20A5150AD46D622A6A12DE0A758EE7DF75F5D10F2FE2585F2348537787063321FFDAC91BB3C3D1D88CBD04A824ED',
		16)

	n19 = int(
		'8614C70089AADE50E5A14DE1FB8FCF0880046E9494EEAD3BF600EBE451E335B4C9E21DE984912BCA15914711A9C359056A2AD0543035E971A2FAA387EA53AAD48A7016735E2BB60716626CAD6CF4F9CC41A59CF31EF07473A1DE08A018CAB7C6B95BF7AC9F501BD42FCC4C7CD834B6A7723B6ABCC9A98146A750A9222CCE2CC7',
		16)
	e19 = int('10001', 16)
	c19 = int(
		'4B6A6A6CE0CD9D8E0DF4FBD2A23AF3FB45FA587406A3E052231519C4B6B0B606D64DC531A29C0A7510928D4487E7BC3D45CDBADB595AE7D53FBDEE70371DEBCB9A938B94DC0F266326A9DF6191E04F82A9CDC067D366926B58A9092F55DB22F8D4BCD9777A99F14ED95083D091DA69F80F448EFF48A21F998BBDC97DAEA135C1',
		16)


	p2 = pollard_p_1(n2, 1 << 256)
	print('frame2的参数和解密结果为：')
	common.output_rsa_parameter(n2, e2, p2, c2)

	p6 = pollard_p_1(n6, 1 << 256)
	print('frame6的参数和解密结果为: ')
	common.output_rsa_parameter(n6, e6, p6, c6)

	p19 = pollard_p_1(n19, 1 << 256)
	print('frame19的参数和解秘结果为：')
	common.output_rsa_parameter(n19, e19, p19, c19)
